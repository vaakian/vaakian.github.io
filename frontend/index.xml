<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Frontends on Study Notes</title><link>https://note.vaakian.com/frontend/</link><description>Recent content in Frontends on Study Notes</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 15 Sep 2022 21:15:58 +0800</lastBuildDate><atom:link href="https://note.vaakian.com/frontend/index.xml" rel="self" type="application/rss+xml"/><item><title>å…³äº tree-shaking</title><link>https://note.vaakian.com/frontend/tree-shaking/</link><pubDate>Thu, 15 Sep 2022 21:15:58 +0800</pubDate><guid>https://note.vaakian.com/frontend/tree-shaking/</guid><description>æœ€è¿‘å¯¹Tree-shakingåšäº†ä¸å°‘çš„äº†è§£å’Œç ”ç©¶ï¼Œè¿™é‡Œåšä¸€äº›ä¸ªäººæ€»ç»“ï¼Œæ–¹ä¾¿ä»¥åé—å¿˜æ—¶è¿›è¡Œå¤ä¹ ã€‚
ä»€ä¹ˆæ˜¯Tree-shaking æœ¯è¯­è§£é‡Š Tree-shakingæ˜¯ä¸€ç§ç”¨äºæ¶ˆé™¤JavaScriptä¸Šä¸‹æ–‡ä¸­çš„æœªå¼•ç”¨ä»£ç (dead-code)çš„ä¼˜åŒ–æŠ€æœ¯ã€‚å®ƒæ˜¯ä¸€ç§åŸºäºES6æ¨¡å—çš„é™æ€ä»£ç åˆ†ææŠ€æœ¯ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±è¿›è¡Œä»£ç çš„æ¶ˆé™¤ï¼Œä»è€Œå‡å°‘ä»£ç ä½“ç§¯ã€‚
é€šä¿—è§£é‡Š ä»è‹±æ–‡å­—é¢æ„æ€â€œæ‘‡æ ‘â€ä¸Šæ¥çœ‹ï¼Œå°±æ˜¯æŠŠä¸€æ£µæ ‘ä¸Šçš„ä¸éœ€è¦çš„å¶å­æ‘‡ä¸‹æ¥ï¼Œåªä¿ç•™éœ€è¦çš„å¶å­ã€‚åœ¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼ŒTree-shakingå°±æ˜¯æŒ‡åœ¨æ‰“åŒ…çš„æ—¶å€™ï¼ŒæŠŠä¸éœ€è¦çš„ä»£ç æ‘‡ä¸‹æ¥ï¼Œåªä¿ç•™éœ€è¦çš„ä»£ç ã€‚
Tree-shakingçš„åŸç† æ—©æœŸå¤§éƒ¨åˆ†nodeåŒ…éƒ½æ˜¯commonJSæ ¼å¼ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡requireæ¥å¼•å…¥ã€‚å®ƒæœ‰ä¸€ä¸ªè‡´å‘½çš„ç¼ºé™·ï¼šå› ä¸ºå®ƒçš„åŠ¨æ€æ€§ï¼Œæ— æ³•åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥å¾ˆéš¾æ‰¾åˆ°ä¸ç”¨çš„ä»£ç è¿›è¡Œtree-shakingã€‚
åˆ°äº†ESModuleæ—¶ä»£ï¼ŒTree-shakingå˜å¾—å®¹æ˜“èµ·æ¥ã€‚
tree-shakingæ¦‚å¿µæœ€æ—©æ˜¯ç”±Rollup.jsæå‡ºçš„ï¼Œå®ƒå°±æ˜¯åˆ©ç”¨ESMçš„é™æ€ä¼˜åŠ¿ï¼Œé€šè¿‡é™æ€åˆ†ææ‰¾å‡ºæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ç„¶åæŠŠæ²¡æœ‰ç”¨åˆ°çš„ä»£ç å»æ‰ã€‚
é‚£ä¹ˆæ—©æœŸæ²¡æœ‰ESMï¼Œtree-shakingæŠ€æœ¯çš„æ—¶å€™ï¼Œæ€ä¹ˆåšåˆ°æŒ‰éœ€æ‰“åŒ…ï¼Ÿ åœ¨Tree-shakingæ²¡æœ‰å…´èµ·çš„æ—¶å€™ï¼Œå‰ç«¯åº“åœ¨æ‰“åŒ…çš„æ—¶å€™å¯ä»¥ä¸è¿›è¡Œbundleï¼Œæ¯ä¸ªç»„ä»¶éƒ½ä¿ç•™æˆå•ç‹¬çš„æ–‡ä»¶ï¼Œå¼•å…¥çš„æ—¶å€™ä¹Ÿéœ€è¦æŒ‰ç…§æ–‡ä»¶ç›®å½•å¼•å…¥ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡â€œæ–‡ä»¶éš”ç¦»â€æ¥è¾¾åˆ°é™æ€æ€§ã€‚è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯ï¼šå¼•å…¥çš„è·¯å¾„ä¼šéå¸¸é•¿ï¼Œå¢åŠ äº†å­¦ä¹ æˆæœ¬ï¼Œä¸å¤Ÿä¼˜é›…ã€‚
import { Button } from &amp;#39;antd/lib/button&amp;#39; import { Table } from &amp;#39;antd/lib/table&amp;#39; æ‰€ä»¥åæ¥å‰ç«¯åº“åœ¨æŒ‰éœ€å¼•å…¥æ—¶ä¼šåŒæ—¶æä¾›ä¸€ä¸ªæ’ä»¶ï¼Œå®ƒä¼šå¸®ä½ è‡ªåŠ¨åŒ¹é…æ–‡ä»¶ç›®å½•ï¼Œç„¶åå¼•å…¥ã€‚æ˜¾è€Œæ˜“è§è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯ï¼šéœ€è¦åœ¨é¡¹ç›®ä¸­é…ç½®é¢å¤–çš„æ’ä»¶ã€‚
import { Button } from &amp;#39;antd&amp;#39; // é€šè¿‡æ’ä»¶è‡ªåŠ¨è½¬æ¢æˆğŸ‘‡ var Button = require(&amp;#39;antd/lib/button&amp;#39;) ä¸ç®¡é…ç½®æ’ä»¶æœ‰å¤šç®€å•ï¼Œåªè¦å¤šä¸€ä¸ªæ­¥éª¤ï¼Œæ€»ä¼šäº§ç”Ÿæ–°çš„é—®é¢˜ï¼Œç»™å¼€å‘è€…å¢åŠ å­¦ä¹ æˆæœ¬ã€‚
å¯ä»¥æ‰“å¼€ https://github.com/umijs/babel-plugin-import çœ‹çœ‹ï¼Œç›¸ä¿¡ä½ ä¹Ÿæ— æ³•åœ¨10åˆ†é’Ÿå†…çœ‹æ‡‚å®ƒçš„ç”¨æ³•å¹¶æˆåŠŸè·‘èµ·æ¥ï¼Œè¿™å°±æ˜¯å¤šä½™çš„å­¦ä¹ æˆæœ¬ã€‚
åœ¨ESMæ—¶ä»£ï¼Œä¹ŸåŒæ—¶è¿›å…¥äº†tree-shakingçš„æ—¶ä»£ å¥½åœ¨æœ‰ESMçš„å¤©ç„¶é™æ€ä¼˜åŠ¿åŠ æŒï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥æ—¢bundleï¼Œåˆä¿ç•™tree-shakingçš„èƒ½åŠ›ã€‚è¿™ä¸€åˆ‡å¯¹äºä½¿ç”¨åº“çš„å¼€å‘è€…æ¥è¯´ï¼Œéƒ½æ˜¯è‡ªåŠ¨å®ç°çš„ï¼Œæ²¡æœ‰é¢å¤–çš„å­¦ä¹ æˆæœ¬ã€‚
Rollupå®˜ç½‘ç¤ºä¾‹ï¼štree-shaking
âš ï¸æ³¨æ„äº‹é¡¹ tree-shakingçš„ç²’åº¦ï¼Œä»¥è¢«exportçš„èµ„æºä¸ºå•ä½ã€‚
åœ¨å¼€å‘ä½ çš„åº“æ—¶ï¼Œä½ éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š
1. æ³¨æ„å‡½æ•°çš„å‰¯ä½œç”¨ // utils.js export const zero = 0 export const getValue = (a) =&amp;gt; { return a.value } // è¿™é‡Œæœ‰å‰¯ä½œç”¨ export const five = getValue({value: 5}) å°±ç®—æ²¡æœ‰å¼•å…¥fiveï¼Œä½†æ˜¯getValueå‡½æ•°ä¼šè¢«æ‰§è¡Œï¼Œè¿™å°±æ˜¯å‰¯ä½œç”¨ã€‚ä¸ºäº†ä¿è¯shakeåçš„ç»“æœ/è¡Œä¸ºä¸€è‡´ï¼Œå°±å¿…é¡»è¦ä¿ç•™è¿™æ®µä»£ç å‡½æ•°ã€‚</description></item><item><title>TypeScript: Three Ways of Overloading</title><link>https://note.vaakian.com/frontend/three-ways-of-overloading/</link><pubDate>Sat, 27 Aug 2022 00:14:17 +0800</pubDate><guid>https://note.vaakian.com/frontend/three-ways-of-overloading/</guid><description>Definition overload means to provide multiple definitions for a function with the same name but different signatures. In TypeScript, we have three ways to achieve this.
1. multiple function definitions function sum(a: number): number; function sum(a: number, b: number): string; // actual implementation function sum(a: any, b?: any) { // do something } 2. Generic function sum&amp;lt;Args extends any[]&amp;gt;(...args: Args): Args[&amp;#39;length&amp;#39;] extends 1 ? number : string; // actual implementation function sum(a: any, b?</description></item><item><title>Write a simple Vite plugin</title><link>https://note.vaakian.com/frontend/vite-plugin/</link><pubDate>Tue, 10 May 2022 14:50:32 +0800</pubDate><guid>https://note.vaakian.com/frontend/vite-plugin/</guid><description>prerequisites åœ¨ webpack ä¸­ï¼Œåˆ†ä¸º plugin å’Œ loaderï¼Œå…¶ä¸­ loader çš„èŒè´£è¢«åˆ’åˆ†ä¸ºå•ä¸€çš„ç¿»è¯‘è½¬æ¢ã€‚ è€Œåœ¨ vite ä¸­ï¼Œå»é™¤äº† loader çš„æ¦‚å¿µï¼Œè€Œæ˜¯å°†ä»£ç è½¬æ¢/ç¼–è¯‘çš„æ¦‚å¿µç»Ÿä¸€æ”¾åˆ°äº† plugin ä¸­å»ã€‚
plugin vite: using plugin
ç›®çš„ ç†è§£æœ€åŸºæœ¬çš„ plugin æ¦‚å¿µï¼Œå¹¶ä¸º vite ç¼–å†™ä¸€ä¸ªæœ€ç®€å•çš„ pluginã€‚
ä»»åŠ¡ï¼šåˆ›å»ºä¸€ä¸ª plugin å°†ä»¥ä¸‹æ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œå¹¶å®ç°import æ–‡ä»¶ï¼šhello.wj
{ &amp;#34;name&amp;#34;: &amp;#34;John&amp;#34;, &amp;#34;age&amp;#34;: 12 } ---- &amp;lt;div&amp;gt;{ name }&amp;lt;/div&amp;gt; &amp;lt;div style=&amp;#34;color: green; font-size: 24px;&amp;#34;&amp;gt;{ age }&amp;lt;/div&amp;gt; ç¼–è¯‘ä¸º
&amp;lt;div&amp;gt;John&amp;lt;/div&amp;gt; &amp;lt;div style=&amp;#34;color: green; font-size: 24px;&amp;#34;&amp;gt;12&amp;lt;/div&amp;gt; åœ¨ js æ–‡ä»¶ä¸­å¼•å…¥
import content from &amp;#39;./hello.wj&amp;#39;; console.log(content); /* &amp;lt;div&amp;gt;John&amp;lt;/div&amp;gt; &amp;lt;div style=&amp;#34;color: green; font-size: 24px;&amp;#34;&amp;gt;12&amp;lt;/div&amp;gt; */ å®ç° åœ¨ vite ä¸­ï¼Œplugin æ¥å—ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«å¾ˆå¤šå±æ€§ï¼Œè¿™é‡Œç”¨åˆ°nameå’Œtransformï¼Œtransform æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å— codeï¼ˆæ–‡ä»¶å†…å®¹ï¼‰å’Œ idï¼ˆæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼‰ã€‚å¦‚æœ transform è¿”å›å€¼ä¸ä¸ºç©ºï¼Œåˆ™è¿™æ—¶å€™å°†è¿”å›çš„å€¼ä½œä¸ºç¼–è¯‘åçš„ä»£ç ï¼Œå¦åˆ™å°†è¿”å›åŸå§‹çš„ codeã€‚</description></item><item><title>Creating a Function and it's prototype</title><link>https://note.vaakian.com/frontend/prototype/</link><pubDate>Tue, 19 Apr 2022 15:48:02 +0800</pubDate><guid>https://note.vaakian.com/frontend/prototype/</guid><description>ç®€å•å›é¡¾ prototype prototype å¯ä»¥ä½œä¸ºå®ä¾‹ä¹‹é—´å…±äº«æ•°æ®çš„ä¸€å—ç©ºé—´ã€‚æ‰€ä»¥å¾€ prototype ä¸Šæ”¾ç½®ä»»ä½•å±æ€§ï¼Œéƒ½å¯ä»¥è¢«æ‰€æœ‰å®ä¾‹è®¿é—®åˆ°ã€‚
function Animal() { // thisæ˜¯å®ä¾‹æœ¬èº« console.log(this.name); } Animal.prototype.name = &amp;#39;Animal&amp;#39;; Animal.prototype.greet = function () { console.log(`hello, i am ${this.name}`); }; const cat = new Animal(); const dog = new Animal(); (cat.__proto__ === Animal.prototype) === dog.__proto__; å½“é€šè¿‡å®ä¾‹æœ¬èº«è®¿é—®ä»»ä½•å±æ€§ï¼Œå…¶è¿‡ç¨‹ä¸ºï¼šè‡ªèº« =&amp;gt; __proto__ =&amp;gt; __proto__ çš„ __proto__ =&amp;gt; null
æ‰€ä»¥
const dog = new Animal(); // ç›¸ç­‰ (dog.greet === Animal.prototype.greet) === dog.__proto__.greet; ä½†å¦‚æœå°†æ„é€ å‡½æ•°æ”¹ä¸º
function Animal() { this.greet = function () { console.</description></item><item><title>TypeScript: Covariance &amp; Contravariance</title><link>https://note.vaakian.com/frontend/covariance-and-contravariance/</link><pubDate>Fri, 15 Apr 2022 13:36:51 +0800</pubDate><guid>https://note.vaakian.com/frontend/covariance-and-contravariance/</guid><description>ä¸ªäººå¤ä¹ ç”¨ï¼Œä¸åšç§‘æ™®ã€‚
åˆ›å»ºä¸¤ä¸ªç±»ï¼ŒDogæ˜¯Animalçš„å­ç±»ã€‚
class Animal {} class Dog extends Animal { bark() {} } å®ç°ä¸€ä¸ªåˆ¤æ–­ç±»å‹çš„Typeï¼Œåˆ¤æ–­Tæ˜¯å¦æ˜¯Uçš„å­ç±»ã€‚
type Assignable&amp;lt;T, U&amp;gt; = T extends U ? true : false æµ‹è¯•ï¼Œç¬¦åˆç»“æœã€‚
type R4 = Assignable&amp;lt;Dog, Animal&amp;gt; // true ä½†å°†åŒæ ·çš„é—®é¢˜æ”¾åˆ°å‡½æ•°çš„parametersä¸Šï¼Œå°±å‘ç”Ÿäº†ä¸ç¬¬ä¸€ç›´è§‰ä¸ä¸€æ ·çš„æƒ…å†µã€‚
type ConsumeAnimal = (target: Animal) =&amp;gt; Animal type ConsumeDog = (target: Dog) =&amp;gt; Dog type R1 = Assignable&amp;lt;Son, Father&amp;gt; // false type R2 = Assignable&amp;lt;Father, Son&amp;gt; // true type R3 = Assignable&amp;lt;Parameters&amp;lt;Son&amp;gt;, Parameters&amp;lt;Father&amp;gt;&amp;gt; // true é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿ é€šè¿‡Googleï¼Œæ‰¾åˆ°ä¸¤ä¸ªå…³é”®è¯ï¼šcovarianceå’Œcontravariance</description></item><item><title>React18: useDeferredValue</title><link>https://note.vaakian.com/frontend/react18-usedeferredvalue/</link><pubDate>Wed, 13 Apr 2022 12:24:53 +0800</pubDate><guid>https://note.vaakian.com/frontend/react18-usedeferredvalue/</guid><description>useDeferredValueçš„åŠŸèƒ½ &amp;amp; åœºæ™¯ æƒ³è±¡ä¸€ä¸ªéå¸¸è€—æ—¶çš„ç»„ä»¶SlowComponentï¼Œå½“æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶ï¼Œåœ¨æ¸²æŸ“ç»“æŸä¹‹å‰ï¼Œæ•´ä¸ªJavaScriptä¸»çº¿ç¨‹è¢«é˜»å¡(block)ï¼Œæ— æ³•å¤„ç†ä»»ä½•äº‹ä»¶ï¼Œå¤„äºå‡æ­»çŠ¶æ€ã€‚
æ‰€ä»¥ä»¥ä¸‹çš„inputåœ¨è¾“å…¥æ–°çš„å€¼æ—¶ï¼Œéœ€è¦ç­‰åˆ°æ‰€æœ‰ç»„ä»¶è¢«renderï¼Œinputæ¡†æ‰ä¼šæ›´æ–°æ˜¾ç¤ºæ–°çš„å€¼ã€‚
è€ŒSlowComponentè€—æ—¶å¤§çº¦1sæ‰è¿”å›ç»“æœï¼Œæ‰€ä»¥ä»é”®ç›˜è¾“å…¥ =&amp;gt; åˆ°é¡µé¢ä¸Šæ˜¾ç¤ºç»“æœï¼Œéœ€è¦ç­‰å¾…1sã€‚
åŒ…æ‹¬inputè¾“å…¥æ¡†ã€‚
function App() { const [text, setText] = useState(&amp;#34;hello&amp;#34;) return ( &amp;lt;div className=&amp;#34;App&amp;#34;&amp;gt; &amp;lt;input value={text} onChange={e =&amp;gt; setText(e.target.value)} /&amp;gt; {/* SlowComponentç»„ä»¶éå¸¸è€—æ—¶ */} &amp;lt;SlowComponent text={text} /&amp;gt; &amp;lt;/div&amp;gt; ) } // é€šè¿‡React.memoä¼˜åŒ–ï¼Œtextä¸å˜æ—¶ï¼Œè¿”å›ç¼“å­˜çš„æ¸²æŸ“ç»“æœã€‚ const SlowComponent = React.memo(({ text }) =&amp;gt; { const now = Date.now() while (Date.now() - now &amp;lt; 500) { // do nothing } return &amp;lt;div&amp;gt;{text}&amp;lt;/div&amp;gt; }) åœ¨çº¿æµ‹è¯•ï¼Œæ”¹å˜1æ¬¡è¾“å…¥æ¡†ï¼Œè¾“å…¥æ¡†éœ€è¦åœ¨500msåå“åº”ã€‚
https://codesandbox.io/s/goofy-khayyam-3q410q?file=/src/App.js
é‚£ä¹ˆå¯ä¸å¯ä»¥å…ˆç«‹åˆ»æ¸²æŸ“å‡ºinputï¼Œå†å»æ¸²æŸ“SlowComponentå‘¢ï¼Ÿ
ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œå°†ã€Œæ¸²æŸ“è¿‡ç¨‹ã€ä»ä¸Šé¢çš„1æ¬¡ï¼Œåˆ†æˆ2æ¬¡ã€‚
æ€ä¹ˆåˆ†ï¼Ÿå°±æ˜¯useDeferredValueå¯ä»¥ç”¨åˆ°çš„åœºæ™¯ï¼š</description></item><item><title>Nginx Reverse Proxy Path</title><link>https://note.vaakian.com/frontend/nginx-reverse-proxy-path/</link><pubDate>Tue, 12 Apr 2022 15:16:09 +0800</pubDate><guid>https://note.vaakian.com/frontend/nginx-reverse-proxy-path/</guid><description>å‡è®¾æœåŠ¡å™¨åŸŸåä¸ºvaakian.comï¼Œè®¿é—®uriä¸ºhttp://vaakian.com/api/userï¼Œå¯¹æ¯”ä»¥ä¸‹åå‘ä»£ç†çš„æ•ˆæœã€‚
1. ç»“å°¾éƒ½ä¸æ‰“æ–œæ / location /api { proxy_pass http://127.0.0.1:8080 } åä»£ç»“æœ
http://127.0.0.1:8080/api/user 2. location æ‰“æ–œæ ï¼Œproxy_pass ä¸æ‰“ location /api/ { proxy_pass http://127.0.0.1:8080 } åä»£ç»“æœ
http://127.0.0.1:8080/api/user æ‰€ä»¥ï¼Œå¦‚æœ proxy_pass ä¸æ‰“æ–œæ ï¼Œé‚£ä¹ˆå®é™…è®¿é—®çš„è·¯ç”±éƒ¨åˆ†æ˜¯åŸå°ä¸åŠ¨çš„æ‹¼æ¥çš„ã€‚
2. location ä¸æ‰“ï¼Œproxy_pass æ‰“æ–œæ  location /api { proxy_pass http://127.0.0.1:8080/ } åä»£ç»“æœï¼Œ
http://127.0.0.1:8080//user 2. location å’Œ proxy_pass éƒ½æ‰“æ–œæ  location /api/ { proxy_pass http://127.0.0.1:8080/ } åä»£ç»“æœï¼Œ
http://127.0.0.1:8080/user æ‰€ä»¥ï¼Œproxy_pass æ‰“æ–œæ æ—¶å®é™…åŒ¹é…åˆ°çš„ location ä¼šè¢«æ¸…æ¥šæ‰ã€‚</description></item><item><title>React18: concurrent rendering</title><link>https://note.vaakian.com/frontend/react18/</link><pubDate>Tue, 12 Apr 2022 14:56:18 +0800</pubDate><guid>https://note.vaakian.com/frontend/react18/</guid><description>React18æ›´æ–°äº†ä»€ä¹ˆï¼Ÿ æœ€å¤§çš„æ›´æ–°å°±æ˜¯å¹¶å‘æ¸²æŸ“(concurrent rendering)ç‰¹æ€§äº†ã€‚è¿™é‡Œå°†åŒæ­¥æ¸²æŸ“å’Œå¹¶å‘æ¸²æŸ“è¿›è¡Œå¯¹æ¯”ï¼Œä»¥åŠäº†è§£å’Œæµ‹è¯•å®ƒæ‰€å½±å“çš„è§†è§‰è¡Œä¸ºã€‚
å…¶æ¬¡ï¼Œä½¿ç”¨react18ï¼Œæ¸²æŸ“æ–¹å¼æœ‰å°çš„å˜åŠ¨å¦‚ä¸‹ï¼š
before
import React from &amp;#39;react&amp;#39; import ReactDOM from &amp;#39;react-dom&amp;#39; import &amp;#39;./index.css&amp;#39; import App from &amp;#39;./App&amp;#39; ReactDOM.render( &amp;lt;React.StrictMode&amp;gt; &amp;lt;App /&amp;gt; &amp;lt;/React.StrictMode&amp;gt;, document.getElementById(&amp;#39;root&amp;#39;) ) after
import { React } from &amp;#39;react&amp;#39; import { createRoot } from &amp;#39;react-dom/client&amp;#39; import &amp;#39;./index.css&amp;#39; import App from &amp;#39;./App&amp;#39; const root = createRoot(document.getElementById(&amp;#39;root&amp;#39;)) root.render(&amp;lt;App /&amp;gt;) å¹¶å‘æ¸²æŸ“ vs åŒæ­¥æ¸²æŸ“ åœ¨åŒæ­¥æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç»„ä»¶æ‰€è®¿é—®çš„å¤–éƒ¨èµ„æºéƒ½èƒ½å¤Ÿä¿è¯ä¸€è‡´ï¼Œå› ä¸ºrenderæ˜¯ä¸€ä¸ªå¤§çš„ä»»åŠ¡ã€‚åœ¨è¿™ä¸ªä»»åŠ¡å®Œæˆä¹‹å‰ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½ä¼šè¢«é˜»å¡ï¼ŒåŒ…æ‹¬é¡µé¢ã€‚å¦‚æœè¿›è¡Œä¸€ä¸ªå¾ˆé‡çš„æ¸²æŸ“å·¥ä½œï¼Œåœ¨å®Œæˆæ¸²æŸ“ä¹‹å‰ï¼Œé¡µé¢å°±ä¼šå¡ä½æ— å“åº”ã€‚
è€Œå¹¶å‘æ¸²æŸ“åˆ™ä¸åŒï¼Œä¸€ä¸ªrenderå¯ä»¥è¢«æ‹†åˆ†æˆå¤šä¸ªç‰‡æ®µï¼Œåœ¨è¿™ä¸ªæœŸé—´å¯ä»¥é¡µé¢å¯ä»¥ç»§ç»­å“åº”ï¼Œä¸ä¼šå¡æ­»ã€‚ä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼šå¦‚æœæŸä¸€æ¬¡æ¸²æŸ“çš„ç»„ä»¶Aï¼ŒBè®¿é—®äº†åŒä¸€ä¸ªå¤–éƒ¨èµ„æºï¼Œè€Œè¿™ä¸ªèµ„æºåœ¨Aæ¸²æŸ“åè¢«æ›´æ”¹ï¼Œç„¶åBå†æ¸²æŸ“ï¼Œå°±å¯¼è‡´äº†è§†è§‰ä¸Šçš„ä¸ä¸€è‡´(visual inconsistent)ï¼Œä¸ç¬¦åˆç›´è§‰ã€‚
ä¾‹å­å¯¹æ¯” å¹¶å‘æ¸²æŸ“(concurrent rendering)ä½“ç°åœ¨APIä¸Šå°±æ˜¯é€šè¿‡startTransitionæ¥è§¦å‘setterå‡½æ•°ã€‚
è¿™é‡Œé€šè¿‡ä¸€ä¸ªåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºé¼ æ ‡ä½ç½®çš„å®éªŒï¼Œæ¥æ›´åŠ æ¸…æ™°çš„å±•ç¤ºè¿™ç§æƒ…å†µã€‚
å½“ç‚¹å‡»incrementæ—¶ï¼Œæ‰‹åŠ¨ä½¿é¡µé¢é‡æ–°æ¸²æŸ“ï¼Œç„¶åæ›´æ–°é¡µé¢xçš„å€¼ã€‚
import { useState, useCallback, useEffect, useRef, startTransition } from &amp;#39;react&amp;#39; import &amp;#39;.</description></item><item><title>åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„ç±»Vueå“åº”å¼æ•°æ®</title><link>https://note.vaakian.com/frontend/mini-reactive-property/</link><pubDate>Fri, 25 Mar 2022 13:02:55 +0800</pubDate><guid>https://note.vaakian.com/frontend/mini-reactive-property/</guid><description>ä¾èµ–ç®¡ç† æ¯ä¸ªå±æ€§é€šè¿‡Depç±»ç®¡ç†ä¾èµ–ï¼Œå½“å±æ€§å˜æ›´ï¼Œåˆ™é€šè¿‡Dep.notify()é€šçŸ¥ä¾èµ–é¡¹æ›´æ–°ã€‚
class Dep { subs = [] addSub(sub) { this.subs.push(sub) } notify() { this.subs.forEach(sub =&amp;gt; sub()) } off() { this.subs = [] } } module.exports = Dep æ”¶é›†ä¾èµ– é€šè¿‡æ‰§è¡Œæ›´æ–°å‡½æ•°watcherFnï¼Œè§¦å‘getterï¼Œæ­¤æ—¶æ”¶é›†åˆ°ä¾èµ–å‡½æ•°watcherFnã€‚ä¾èµ–ç®¡ç†ç±»Depåœ¨getterä¸­åˆ›å»ºï¼Œå¦‚æœæ²¡æœ‰ä¾èµ–ï¼ˆå³æ²¡æœ‰åœ¨watcherFnå­˜åœ¨æ—¶è§¦å‘getterï¼‰ï¼Œé‚£å°±ä¸ä¼šåˆ›å»ºDepå¯¹è±¡ï¼Œç›¸å¯¹é«˜æ•ˆï¼ŒèŠ‚çœèµ„æºã€‚
å¤„ç†computedå±æ€§ åˆå§‹åŒ–æ—¶ï¼Œæ‰§è¡Œcomputedå‡½æ•°ï¼Œè§¦å‘getterï¼Œæ”¶é›†ç›¸å…³ä¾èµ–ã€‚ å°†æ¯ä¸ªcomputedçš„è¿”å›å€¼ä¹Ÿä½œä¸ºä¸€ä¸ªå±æ€§æ”¾åˆ°æœ€ç»ˆçš„ä»£ç†å±æ€§ä¸Šï¼Œå¹¶ä¸”ä¸dataåŒçº§åˆ«æ”¶é›†ä¾èµ–ã€‚
const Dep = require(&amp;#39;./Dep&amp;#39;) // æš‚å­˜è®¿é—®å‡½æ•° let watcherFn // ä¾èµ–æ”¶é›†è¿‡ç¨‹ï¼šæš‚å­˜ =&amp;gt; æ‰§è¡Œï¼Œè®¿é—®å±æ€§ï¼Œè¢«æ”¶é›† =&amp;gt; æ¸…é™¤ const watcher = (fn) =&amp;gt; { watcherFn = fn watcherFn() watcherFn = null } function Vue({ data, computed, watch }) { // ä¾èµ–ç®¡ç†ç±»ï¼Œæ¯ä¸ªå±æ€§keyå¯¹åº”ä¸€ä¸ªDepå¯¹è±¡ const deps = {} const instance = new Proxy(data, { get(target, key) { // å¦‚æœwatcherFnä¸å­˜åœ¨ï¼Œåˆ™ä¸æ˜¯åœ¨æ”¶é›†ä¾èµ–ï¼ˆä¸æ˜¯é€šè¿‡watcherå‡½æ•°è§¦å‘çš„ï¼‰ï¼Œç›´æ¥è¿”å›è¯¥å€¼å³å¯ if (watcherFn) { // å¦‚æœæ˜¯watcherFnäº§ç”Ÿçš„getï¼Œæ‰åˆ›å»ºä¾èµ–ã€‚ // Warnï¼šåªæœ‰watcherFnäº§ç”Ÿçš„getæ‰æœ‰æ„ä¹‰ if (!</description></item><item><title>Implement async/await with generator/yield</title><link>https://note.vaakian.com/frontend/async-generator/</link><pubDate>Sun, 06 Mar 2022 14:11:03 +0800</pubDate><guid>https://note.vaakian.com/frontend/async-generator/</guid><description>async/awaitä¸æ˜¯é­”æ³•ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåº•å±‚ä¸ç”Ÿæˆå™¨generatorå¯†ä¸å¯åˆ†ã€‚ è¿™é‡Œä»¥å­¦ä¹ ä¸ºç›®çš„ï¼Œç®€å•ç”¨ä¸€ä¸ªä¾‹å­æ¥æ¨¡æ‹Ÿå®ƒä»¬çš„è¡Œä¸ºï¼Œèƒ½å¤Ÿæœ‰ä¸€ä¸ªç›´è§‚çš„ç†è§£ã€‚
éœ€è¦çš„å‰ç½®çŸ¥è¯†ï¼Œä¸å†èµ˜è¿°ï¼š
ES6 async/await ES6 generator åˆ›å»ºä¸€ä¸ªå¼‚æ­¥åŠ æ³•å‡½æ•° å»¶è¿Ÿ1ç§’è¿”å›åŠ æ³•ç»“æœï¼Œæ–¹ä¾¿å®éªŒã€‚
function addAsync(x: number, y: number): Promise&amp;lt;number&amp;gt; { return new Promise((resolve, reject) =&amp;gt; { setTimeout(() =&amp;gt; { resolve(x + y) }, 1000) }) } å®ç°å•ä¸ªyieldï¼ˆæ¨¡æ‹Ÿawaitï¼‰ function doAsync(g: () =&amp;gt; Generator): void { // è°ƒç”¨å¼‚æ­¥å‡½æ•°mainï¼Œè¿”å›ä¸€ä¸ªå¯è¿­ä»£çš„iterator const it = g() // è°ƒç”¨nextï¼Œè¿è¡Œåˆ°ç¬¬ä¸€ä¸ªyieldä¹‹åæš‚åœ const { value } = it.next() // è°ƒç”¨nextåˆ™è®©yieldä¹‹åçš„ä»£ç ç»§ç»­è¿è¡Œï¼Œå¹¶å°†vä¼ é€’ç»™yieldä½œä¸ºè¿”å›å€¼ value.then(v =&amp;gt; it.next(v)) } function* main() { const result: number = yield addAsync(5, 2) console.</description></item><item><title>WebRTC: Signaling Server</title><link>https://note.vaakian.com/frontend/webrtc-signaling-server/</link><pubDate>Fri, 21 Jan 2022 21:20:40 +0800</pubDate><guid>https://note.vaakian.com/frontend/webrtc-signaling-server/</guid><description>Node.jsæœåŠ¡ç«¯ æœåŠ¡ç«¯æ‰€éœ€è¦åšçš„äº‹æƒ…ï¼šå­˜å‚¨å’Œå¹¿æ’­æˆ¿é—´ä¿¡æ¯ &amp;amp; ä¿¡ä»¤äº¤æ¢ä¸­ä»‹ï¼ŒåŒ…æ‹¬sdp(SessionDescription)å’Œice(iceCandidate)ã€‚
æ¥æ”¶åŸºæœ¬çš„äº‹ä»¶ï¼šjoin, offer, answer, icecandidate, leave
sdpç”¨äºåå•†ä¼šè¯è¿æ¥æ–¹å¼ä¹‹å‰çš„å¿…è¦ä¿¡æ¯ iceåå•†çš„ç»“æœï¼Œç”¨äºå€™é€‰çš„è¿æ¥æ–¹å¼ å®¢æˆ·ç«¯â€ä»…åœ¨â€œjoinæ—¶å¸¦ä¸Šidå’Œnickï¼Œç„¶åæœåŠ¡å™¨å­˜å‚¨è¯¥ä¿¡æ¯ä¸Clientå¯¹åº”ã€‚å­˜å‚¨æ–¹å¼è§ï¼šhow to keep track of clients with WebSocketsï¼Œæˆ–è€…ç›´æ¥åœ¨server.clientsä¸­æŒ‚è½½ä¿¡æ¯ã€‚
åœ¨offerå’Œansweræ—¶ï¼ŒæœåŠ¡å™¨å–å‡ºå¯¹åº”çš„idå’Œnickè½¬å‘å‡ºå»ã€‚
offerä¸€å®šæ˜¯å¹¿æ’­ï¼Œé€šè¿‡server.clients.forEachå‘é€ answeræ˜¯å®šå‘å‘é€ï¼Œå¸¦æœ‰receiverIdï¼Œé€šè¿‡clientsMapå‘é€ clientå¯¹åº”è¡¨
class ClientsMap { constructor(server) { this.clients = new Map() server.on(&amp;#39;connection&amp;#39;, (ws, req) =&amp;gt; { ws.on(&amp;#39;message&amp;#39;, (message) =&amp;gt; { const data = JSON.parse(message) if (data.type === &amp;#39;join&amp;#39;) { this.clients.set(data.id, { id: data.id, nick: data.nick, ws: ws }) // åŠ å…¥æ—¶ï¼Œå…ˆæ³¨å†Œå¥½ç¦»å¼€äº‹ä»¶ ws.on(&amp;#39;close&amp;#39;, () =&amp;gt; { this.</description></item><item><title>TypeScript</title><link>https://note.vaakian.com/frontend/typescript/</link><pubDate>Fri, 21 Jan 2022 21:15:58 +0800</pubDate><guid>https://note.vaakian.com/frontend/typescript/</guid><description>åŠ¨æ€å±æ€§ å¯¹è±¡åŠ¨æ€å±æ€§ å³æŸä¸ªå¯¹è±¡çš„å±æ€§ç±»å‹ ä¾èµ–äº å¦å¤–ä¸€ä¸ªå±æ€§ï¼Œå½“Messageçš„typeä¸ºofferæ—¶ï¼Œpayloadçš„å±æ€§ä¸ºRTCSessionDescriptionInitï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè”åˆç±»å‹PeerInfo | RTCSessionDescriptionInit | RTCIceCandidateInitã€‚
interface PeerInfo { id: string nick: string } interface PayloadMap { join: PeerInfo offer: RTCSessionDescriptionInit answer: RTCSessionDescriptionInit icecandidate: RTCIceCandidateInit // leaveåªæœ‰å•æ¥å—æƒ…å†µï¼Œå®¢æˆ·ç«¯ä¸ä¼šä¸»åŠ¨å‘é€ã€‚ leave: PeerInfo } type Message = { [K in keyof PayloadMap]: { type: K nick: string receiverId?: string | null // playloadçš„ç±»å‹å–å†³äºtypeçš„å€¼ payload: PayloadMap[K] } }[keyof PayloadMap] å•æ‹å‡ºæ¥è¿™ä¸€æ®µï¼Œå…¶å®æ˜¯mapå‡ºäº†å¤šä¸ªç±»å‹ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªç±»å‹ã€‚ç„¶åMessageé€šè¿‡keyof PayloadMapæ¥è·å–åˆ°ä¸€ä¸ªè”åˆç±»å‹ã€‚
const MessageTypeMap = { [K in keyof PayloadMap]: { type: K nick: string id: string receiverId?</description></item><item><title>WebRTC: Multi-RTCPeerCoonection</title><link>https://note.vaakian.com/frontend/multi-rtcpeercoonection/</link><pubDate>Fri, 21 Jan 2022 16:24:57 +0800</pubDate><guid>https://note.vaakian.com/frontend/multi-rtcpeercoonection/</guid><description>ä¸€ï¼‰æŠ›å‡ºé—®é¢˜ ä¸€ä¸ªRTCPeerConnectionåªèƒ½å¯¹åº”å¦å¤–ä¸€ä¸ªRTCPeerCoonectionï¼Œå¦‚æœæƒ³è¦å®ç°å¤šäººä¼šè®®ã€‚é‚£ä¹ˆéœ€è¦ç»Ÿä¸€ç®¡ç†å¤šä¸ªRTCPeerConnectionï¼Œä»»ä½•æœ¬åœ°æ•°æ®éƒ½è¦å¹¿æ’­åˆ°å¤šä¸ªRTCPeerConnectionä¸­å»ã€‚
äºŒï¼‰èŒè´£åˆ†å‰² åœ¨é€šè¿‡çº¯åŸç”Ÿçš„RTCPeerConnectionå®ç°åŒäººä¸€å¯¹ä¸€è§†é¢‘ä¼šè®®æ—¶ï¼Œå‘ç°ä»£ç åˆ†éš”æ—¶å·²ç»åŠ›ä¸ä»å¿ƒäº†ã€‚å¦‚ä½•å®ç°å¤šäººæ›´éœ€è¦ä¸€äº›æ˜ç¡®çš„èŒè´£åˆ†å‰²ã€‚
ç®¡ç†å¤šä¸ªPeerConnection å°†æœ¬åœ°æ•°æ®å¹¿æ’­åˆ°å¤šä¸ªPeerConnection *å¦‚ä½•å°†PeerConnectionä¸WebSocketä¸­çš„Clientç»‘å®šï¼ˆå¦‚ä½•è¯†åˆ«èº«ä»½ï¼‰ Trackæ¦‚å¿µï¼šç®¡ç†å¤šä¸ªTrackåˆ°ä¸€ä¸ªStreamä¸­ æœ¬åœ°Streamæ¨åˆ°è¿œç¨‹ 2.1 å¦‚ä½•è¯†åˆ«èº«ä»½ å¦‚ä½•åœ¨WebSocketå’ŒPeerConnectionå»ºç«‹è¿æ¥è¿‡ç¨‹ä¸­å»ç¡®å®šèº«ä»½ï¼Œå¦‚ä½•ç¡®å®šä¸¤è€…ç›¸å…³è”ï¼Ÿ
é¦–å…ˆè¦ç†æ¸…æ¥šï¼Œå»ºç«‹è¿æ¥çš„æ•´ä¸ªæµç¨‹ã€‚ç„¶åæ‰¾å‡ºåº”è¯¥åœ¨å“ªä¸ªé˜¶æ®µå»è¿›è¡Œèº«ä»½ç¡®è®¤ã€‚
åŠ å…¥æˆ¿é—´ï¼Œå‘é€JoinRoomæ¶ˆæ¯ï¼Œå¸¦ä¸Šè‡ªå·±çš„nickå’Œidï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰ï¼ŒæœåŠ¡å™¨å­˜å‚¨ä¿¡æ¯å¯¹åº”ï¼Œå›å¤æˆ¿é—´Clientsåˆ—è¡¨ã€‚ å¦‚æœæˆ¿é—´æœ‰äººï¼Œå‘é€Offeræ¶ˆæ¯ï¼ˆå¸¦nickå’Œidï¼‰ï¼ŒæœåŠ¡å™¨å¹¿æ’­ä¹‹åï¼Œå…¶ä»–äººå›å¤Answeræ¶ˆæ¯ï¼ˆå¸¦ä¸ªäººä¿¡æ¯å’Œå°†è¦å‘å¾€çš„idï¼‰ å‰ç«¯æ¥æ”¶åˆ°Answerï¼Œå°†å¯¹åº”çš„PeerConnectionä¸è¯¥idå’Œnickå¯¹åº”ã€‚æ­¤åçš„è¿æ¥å°±å®¹æ˜“å¯¹åº”äº†ã€‚ peerConnection.createOffer() // 1. åˆ›å»ºoffer .then(offer =&amp;gt; { return peerConnection.setLocalDescription(offer); }) .then(() =&amp;gt; { // 2. å‘é€offerï¼ˆå¹¿æ’­ï¼‰ return ws.send(JSON.stringify({ type: &amp;#39;offer&amp;#39;, nick: nick, id: id, sdp: peerConnection.localDescription })); }) .then(() =&amp;gt; { return new Promise((resolve, reject) =&amp;gt; { // 3. æ¥æ”¶answer ws.onmessage = (event) =&amp;gt; { const data = JSON.</description></item><item><title>React Hooks</title><link>https://note.vaakian.com/frontend/react-hooks/</link><pubDate>Tue, 18 Jan 2022 14:47:17 +0800</pubDate><guid>https://note.vaakian.com/frontend/react-hooks/</guid><description>[TOC]
useMemo åƒä¸‡ä¸è¦æŠŠuseMemoå’ŒReact.memoæ··ä¸ºä¸€è°ˆï¼Œä¸¤è€…éƒ½æ˜¯æ ¹æ®ä¾èµ–å˜åŒ–æ¥ç¼“å­˜æ•°æ®çš„ã€‚useMemo(fn, deps)å‚ç…§ç¬¬äºŒä¸ªå‚æ•°åˆ—è¡¨çš„å˜åŒ–è¿”å›æ–°çš„æ•°æ®ï¼Œå¦åˆ™è¿”å›ç¼“å­˜çš„æ•°æ®ã€‚è€ŒReact.memoåªä¼šåœ¨ç»„ä»¶çš„propså˜åŒ–æ—¶é‡æ–°æ¸²æŸ“è¯¥ç»„ä»¶ã€‚
ä½¿ç”¨åœºæ™¯ æœ‰éå¸¸è€—æ—¶çš„è®¡ç®—ï¼Œæ¯”å¦‚ä»¥ä¸‹ä¾‹å­ä¸­çš„expensiveComputationï¼Œæ¯ä¸€æ¬¡ç»„ä»¶æ¸²æŸ“ï¼Œéƒ½ä¼šè°ƒç”¨è¯¥å‡½æ•°ï¼Œå¹¶ä¸”é‡æ–°è®¡ç®—ã€‚ä½†å…¶å®aå’Œbå¹¶æ²¡æœ‰å˜åŒ–æ—¶ï¼Œè®¡ç®—çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨åˆ°useMemoå°†ç»“æœç¼“å­˜ä¸‹æ¥ï¼Œè€Œæ— éœ€é‡æ–°è®¡ç®—ã€‚
function App() { const [a, setA] = useState(1) const [b, setB] = useState(2) // const value = expensiveComputation(a, b) const value = useMemo(() =&amp;gt; expensiveComputation(a, b), [a, b]) return &amp;lt;div&amp;gt;result: {value}&amp;lt;/div&amp;gt; }
- ä»»ä½•**hook**çš„ä¾èµ–ä¸ºå¯¹è±¡æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ã€Œå­—é¢ä¸Šã€ç›¸åŒï¼Œä½†ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ä¾èµ–åˆ¤æ–­é”™è¯¯ã€‚å› ä¸º**hook**çš„ä¾èµ–æ•°ç»„å¯¹æ¯”æ˜¯æµ…å±‚çš„å¯¹æ¯”ï¼Œä¹Ÿå°±æ˜¯ `===` å¯¹æ¯”ã€‚å› ä¸ºæ¯æ¬¡æ¸²æŸ“æ—¶ï¼Œç»„ä»¶å†…çš„æ‰€æœ‰å­—é¢å˜é‡éƒ½ä¼šè¢«é‡æ–°åˆ›å»ºï¼Œæ‰€ä»¥é‡åˆ°å¯¹è±¡åº”è¯¥è¦æ ¼å¤–æ³¨æ„ã€‚ &amp;gt; å¯¹è±¡åˆ¤å®šç›¸ç­‰ ```js const obj = {count: 1} console.log(obj === obj) // true // å¼•ç”¨ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ä¸ºfalse console.log({count: 1} === {count: 1}) // false ä»¥ä¸‹ä¾‹å­ï¼Œeffectä¸­çš„ä¾èµ–æ˜¯å¯¹è±¡ï¼Œè™½ç„¶a, bæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œobjçš„å­—é¢ä¸Šçœ‹èµ·æ¥ä¹Ÿæ²¡ç”¨å˜åŒ–ã€‚ä½†æ˜¯åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¼•ç”¨ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šæ‰§è¡Œeffectã€‚</description></item><item><title>WebRTC: RTCPeerConncetion</title><link>https://note.vaakian.com/frontend/webrtc-connection/</link><pubDate>Sat, 15 Jan 2022 13:29:47 +0800</pubDate><guid>https://note.vaakian.com/frontend/webrtc-connection/</guid><description>è®ºæ–‡è‰ç¨¿
what is WebRTC WebRTC(Web Real-Time Communication)æ˜¯ä¸€ä¸ªæœ€å…ˆç”±Googleå‘å¸ƒçš„ç‚¹å¯¹ç‚¹ï¼ˆPeer-to-Peerï¼‰é€šä¿¡åè®®ï¼Œç›®å‰å·²ç»è¢«å„å¤§æµè§ˆå™¨æ‰€å†…ç½®ï¼Œæ—©æœŸä¸åŒæµè§ˆå™¨çš„APIæœ‰ç»†å¾®å·®åˆ«ï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨åšå…¼å®¹ã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨MDNæ‰€æ¨èçš„WebRTC adapter.jsæ¥è§£å†³å…¼å®¹é—®é¢˜ã€‚
å…¶æ¬¡å®ƒä¸ä»…ä»…é€‚ç”¨äºæµè§ˆå™¨ï¼Œä¹Ÿå¯ä»¥åœ¨ä»»ä½•å…¶å®ƒä¸åŒå¹³å°çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œåªè¦ç¬¦åˆWebRTCçš„è§„èŒƒå³å¯ã€‚
ä¿¡é“å»ºç«‹æµç¨‹ ä¸¤ä¸ªå®ä½“ï¼ˆPeerï¼‰è¦å»ºç«‹è¿æ¥æˆ–è€…è¯´ä¿¡é“ä¹‹å‰ï¼Œéœ€è¦å…ˆè¿›è¡Œä¸€é¡¹æœ€æœ€é‡è¦çš„å·¥ä½œï¼Œå³ä¿¡ä»¤äº¤æ¢ã€‚å®ƒå°†ä¸¤ä¸ªå®ä½“çš„ä¿¡æ¯ï¼ˆåŒ…å«IPåœ°å€ã€ç«¯å£ç­‰ç­‰å„ç§ç”¨äºå»ºç«‹è¿æ¥çš„å¿…è¦ä¿¡æ¯ï¼‰è¿›è¡Œäº’ç›¸äº¤æ¢ï¼ŒåŒæ–¹æ‹¿åˆ°ä¿¡æ¯åå»ºç«‹ç‹¬ç«‹çš„ä¿¡é“ã€‚æ­¤åï¼Œä¸¤ä¸ªå®ä½“å°±å¯ä»¥é€šè¿‡ä¿¡é“è¿›è¡Œé€šä¿¡äº†ï¼Œæ— éœ€å†é€šè¿‡æœåŠ¡å™¨è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚
ä¸¤ç§é€šä¿¡æ–¹å¼çš„ä¼˜ç¼ºç‚¹ ç‚¹å¯¹ç‚¹é€šä¿¡æ–¹å¼ä¸åŒäºä¼ ç»Ÿçš„ä¸­å¿ƒåŒ–é€šä¿¡æ–¹å¼ï¼Œéœ€è¦ä¸€å°æˆ–è€…å¤šå°æœåŠ¡å™¨è¿›è¡Œæ•°æ®è½¬å‘æˆ–è€…å­˜å‚¨ï¼Œè¿™æ ·ä¼šå¯¼è‡´æœåŠ¡å™¨çš„å¸¦å®½å’Œè®¡ç®—å‹åŠ›å¢å¤§ï¼Œè€Œå½“æœåŠ¡å™¨çš„è´Ÿè½½å¢åŠ æ—¶ï¼Œä¼šè¿›è€Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§ä¸‹é™ï¼Œä¸€æ—¦ä¸­å¿ƒæœåŠ¡å™¨å®•æœºï¼Œæ‰€æœ‰ç”¨æˆ·çš„é€šä¿¡å°†å…¨éƒ¨ä¸­æ–­ã€‚è€Œå¦‚æœé‡‡ç”¨ç‚¹å¯¹ç‚¹é€šä¿¡æ–¹å¼ï¼Œçœå»äº†æœåŠ¡å™¨ä¸­è½¬å­˜å‚¨ç¯èŠ‚ï¼Œé™ä½äº†å„ä¸ªå®ä½“ä¹‹é—´ä¾èµ–æ€§ã€‚ç”¨æˆ·ä¹‹é—´å¯ä»¥ç›´æ¥é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼ŒæŸä¸ªå®ä½“ä¸­æ–­ä»…ä»…å½±å“å®ƒè‡ªèº«ï¼Œè¿™æ ·æ—¢å¯ä»¥èŠ‚çœæœåŠ¡å™¨çš„èµ„æºï¼Œåˆæé«˜äº†ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚
ä¸è¿‡ï¼Œç‚¹å¯¹ç‚¹é€šä¿¡ä¹Ÿæœ‰è‡ªèº«çš„ç¼ºç‚¹ï¼Œç”±äºè§†é¢‘ä¼šè®®å±äºå¤šå¯¹å¤šçš„è¿æ¥ï¼Œæ¯ä¸ªå®ä½“è¦å’Œå…¶å®ƒæ‰€æœ‰å®ä½“éƒ½å»ºç«‹è¿æ¥ï¼Œéšç€ç³»ç»Ÿä¸­å®ä½“çš„å¢åŠ ï¼Œå•ä¸ªå®ä½“çš„å‹åŠ›ä¹Ÿä¼šéšä¹‹å¢åŠ ã€‚è€Œé‡‡ç”¨çš„ä¸­å¿ƒæœåŠ¡å™¨è½¬å‘å­˜å‚¨æ–¹å¼å°±ä¸ä¼šå‡ºç°è¿™ç§é—®é¢˜ï¼Œ æ¯ä¸ªå®ä½“åªéœ€è¦å’Œä¸­å¿ƒæœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œä¸­å¿ƒæœåŠ¡å™¨è´Ÿè´£å­˜å‚¨æ•°æ®å’Œè½¬å‘æ•°æ®åˆ°å…¶å®ƒå®ä½“ã€‚
æ‰€ä»¥ï¼Œåœ¨å®ä½“è¾ƒå°‘ã€ä¼ è¾“æ•°æ®é‡å¤§ã€ç½‘ç»œå»¶è¿Ÿè¦æ±‚æ›´é«˜çš„åœºæ™¯ä¸‹ï¼Œç‚¹å¯¹ç‚¹é€šä¿¡æ–¹å¼æ¯”è¾ƒé€‚åˆï¼Œåä¹‹ï¼Œä¸­å¿ƒæœåŠ¡å™¨è½¬å‘å­˜å‚¨æ–¹å¼æ¯”è¾ƒé€‚åˆã€‚
RTCPeerConnection RTCPeerConnectionè´Ÿè´£å¾ˆå¤šäº‹æƒ…ï¼ŒåŒ…æ‹¬ï¼š
ä¿¡ä»¤å¤„ç†ï¼ˆsingal processingï¼‰ ç¼–è§£ç ï¼ˆCodec handlingï¼‰ ç‚¹å¯¹ç‚¹è¿æ¥ï¼ˆP2P connectionï¼‰ å®‰å…¨ï¼ˆSecurityï¼‰ æµé‡æ§åˆ¶ï¼ˆbandwidth managementï¼‰ â€¦â€¦ RTCåˆ›å»ºè¿æ¥è¿‡ç¨‹ä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ªä¿¡ä»¤æœåŠ¡å™¨è¿›è¡ŒSDPä¿¡æ¯äº¤æ¢ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥é€šè¿‡WebSocketè¿›è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡HTTPè¿›è¡Œï¼Œå½“ç„¶WebSocketæœ€ä½³ã€‚
const conn = new SomeWebsocketConn() const pc = new RTCPeerConnection(null) function sendOffer(desc) { // å‘é€offeråˆ°æœåŠ¡å™¨ä¸Š conn.send({type: &amp;#39;offer&amp;#39;, sdp: desc}) // .then(gotAnswer) } // å½“æˆåŠŸåˆ›å»ºofferæ—¶è°ƒç”¨ pc.createOffer(gotOffer) function gotOffer(desc) { pc.setLocalDescription(desc) // å‘é€åˆ°æœåŠ¡å™¨ sendOffer(desc) } // å½“æœåŠ¡å™¨è¿”å›answeræ—¶è°ƒç”¨ conn.</description></item><item><title>Vueå“åº”å¼åŸç†</title><link>https://note.vaakian.com/frontend/vue-reactive/</link><pubDate>Fri, 14 Jan 2022 21:22:48 +0800</pubDate><guid>https://note.vaakian.com/frontend/vue-reactive/</guid><description>å¼€å§‹ ä¼—æ‰€å‘¨çŸ¥ï¼ŒVueçš„å“åº”å¼å®ç°æ–¹å¼æœ‰ä¸¤ç§ï¼Œåœ¨Vue2ä¸­é€šè¿‡ã€ŒObject.definePropertyã€é‡æ–°å®šä¹‰å±æ€§çš„descriptorä¸­çš„getter/setterå®ç°æ¥ã€‚è€ŒVue3é€šè¿‡ES6çš„â€œæ–°äººâ€ã€ŒProxyã€æ¥å®ç°ã€‚
Vue2ï¼šObject.defineProperty ç½‘ä¼ ï¼š&amp;ldquo;Object.definePropertyæ— æ³•ç›‘æ§åˆ°æ•°ç»„ä¸‹æ ‡çš„å˜åŒ–ï¼Œå¯¼è‡´é€šè¿‡æ•°ç»„ä¸‹æ ‡æ·»åŠ å…ƒç´ ï¼Œä¸èƒ½å®æ—¶å“åº”ï¼›&amp;rdquo;
çº é”™ï¼š ä¸ºä»€ä¹ˆVue2ä¸­ä¸åŠ«æŒæ•°ç»„ï¼Ÿ
æ•°ç»„çš„ä½ç½®ä¸å›ºå®šï¼Œæ•°é‡å¤šå˜ï¼Œæ­£å¸¸å¯¹è±¡keyå¯¹åº”valueä¸€èˆ¬ä¸ä¼šå˜ï¼Œä½†æ˜¯å¦‚æœæ•°ç»„åˆ é™¤äº†æŸä¸ªå…ƒç´ ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªå…ƒç´ è¢«åˆ é™¤æˆ–è€…å¤´éƒ¨å¢åŠ ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆå°†å¯¼è‡´åé¢æ‰€æœ‰çš„keyå¯¹åº”valueé”™ä½ï¼Œå¦‚æœ6ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±ä¼šè§¦å‘5æ¬¡setã€‚
æ•°ç»„å…ƒç´ å¯èƒ½éå¸¸éå¸¸å¤šï¼Œæ¯ä¸ªå…ƒç´ è¿›è¡ŒåŠ«æŒæœ‰ä¸€å®šæµªè´¹ï¼Œè¿™å¯èƒ½æ˜¯Evan youå¯¹æ€§èƒ½çš„è€ƒè™‘ã€‚
Vue2å°†æ•°ç»„çš„7ä¸ªå˜å¼‚æ–¹æ³•è¿›è¡Œäº†é‡å†™ï¼Œä¹Ÿå°±æ˜¯æ›´æ”¹äº†ArrayåŸå‹ä¸Šçš„æ–¹æ³•è¾¾åˆ°åŠ«æŒå˜åŒ–ã€‚
Vue2å°†å¯¹è±¡æ–°å¢å±æ€§/æ•°ç»„ä¿®æ”¹ç­‰æ“ä½œï¼Œé€šè¿‡Vue.setæ¥ç»Ÿä¸€å®ç°ï¼Œè¿™æ ·å…¶å®æ˜¯ç›´æ¥å‘Šè¯‰Vueè‡ªå·±çš„setè¡Œä¸ºï¼Œå³è¦æ–°å¢/ä¿®æ”¹çš„å±æ€§åï¼Œç„¶åé‡æ–°åŠ«æŒæˆ–è€…é€šçŸ¥ä¿®æ”¹Deps[key].notify()ï¼ŒVue2æ‰å¯ä»¥ç›‘æµ‹åˆ°ã€Œæ–°å¢æ•°æ®/æ•°ç»„ä¸‹æ ‡ã€çš„å˜åŒ–ã€‚
ä»¥ä¸‹ä»£ç æµ‹è¯•æ‹¦æˆªæ•°ç»„ä¼šå‘ç”Ÿçš„æƒ…å†µ
const arr = [1, 2, 3, 4, 5, 6] for (let key in arr) { let value = arr[key] Object.defineProperty(arr, key, { get() { console.log(`get: ${key}`) return value }, set(newValue) { console.log(`set: ${key}to ${newValue}`) return value = newValue } }) } arr[0] = 999 // æ‰“å°ï¼šsetï¼š0 to 999 arr[3] // æ‰“å°ï¼šgetï¼š3 arr.</description></item><item><title>Reactä¹‹ï¼šè‡ªå®šä¹‰hooks: useCamera</title><link>https://note.vaakian.com/frontend/usecamera/</link><pubDate>Tue, 14 Dec 2021 15:55:03 +0800</pubDate><guid>https://note.vaakian.com/frontend/usecamera/</guid><description>âš ï¸æ³¨ï¼šä»è€åšå®¢è¿ç§»ï¼Œå¯èƒ½æœ‰æ’ç‰ˆé—®é¢˜ã€‚
å°è¯•ç”¨æµè§ˆå™¨APIå°è£…ä¸€ä¸ªè¯»å–æ‘„åƒå¤´è§†é¢‘æµçš„useCameraè‡ªå®šä¹‰hooksï¼Œä¸€æ­¥ä¸€æ­¥ä¼˜åŒ–ï¼Œæ€»ç»“ä¸€ä¸‹å¾—åˆ°ç›®å‰ä¸ºæ­¢çš„æœ€ä½³å®è·µã€‚ é¦–å…ˆï¼Œæ‘„åƒå¤´è¯»å–APIéœ€è¦ä¼ å…¥æœ€åŸºæœ¬çš„å‚æ•°constraintsï¼Œé€šè¿‡promiseæ–¹å¼å¾—åˆ°streamåä¼šå±•ç¤ºåˆ°videoæ ‡ç­¾ä¸Šï¼Œé‚£ä¹ˆuseCameraåº”è¯¥æ¥å—ä¸€ä¸ªèƒ½å¤Ÿè¯»å–åˆ°videoæ ‡ç­¾çš„å‚æ•°ï¼Œé‚£ä¹ˆé¦–é€‰refï¼Œå¾—åˆ°å¦‚ä¸‹ç¬¬ä¸€ç‰ˆä»£ç ï¼š
function useCamera(constraints, videoRef) { const storedStream = useRef(null) // å½“streamæ”¹å˜æ—¶ï¼Œåˆ›å»ºæ–°çš„stopå‡½æ•° const stop = useCallback(() =&amp;gt; { storedStream.current.getTracks().forEach(track =&amp;gt; track.stop()) }, [storedStream.current]) // å½“constraints/videoRefæ”¹å˜æ—¶ï¼Œåˆ›å»ºæ–°çš„startå‡½æ•° const start = useCallback(() =&amp;gt; { navigator.mediaDevices.getUserMedia(constraints) .then(stream =&amp;gt; { console.log(&amp;#39;setting stream&amp;#39;) videoRef.current.srcObject = stream storedStreamRef.current = stream }) .catch(err =&amp;gt; { console.error(err) }) }, [constraints, videoRef]) // constraintsæ”¹å˜æ—¶ï¼Œstopä¸Šä¸€æ¬¡çš„åª’ä½“æµå¹¶é‡æ–°è¯·æ±‚ useEffect(() =&amp;gt; { start() return stop }, [constraints]) return [start, stop] } ç„¶ååœ¨ç»„ä»¶ä¸­è°ƒç”¨åˆ›å»ºçš„hooksï¼ŒåŠŸèƒ½ä¸Šè¿è¡Œæ­£å¸¸ã€‚</description></item><item><title>Introduction</title><link>https://note.vaakian.com/frontend/introduction/</link><pubDate>Tue, 14 Jan 2020 20:09:20 +0800</pubDate><guid>https://note.vaakian.com/frontend/introduction/</guid><description>Getting Started ä»å¾ˆä¹…å¾ˆä¹…ä»¥å‰å°±æƒ³è®°å½•ä¸‹æ¥æ—¥å¸¸çš„å­¦ä¹ ç¬”è®°ï¼ˆä¸æ˜¯åšå®¢ï¼‰ï¼Œä½†éƒ½æ— ç–¾è€Œç»ˆã€‚ä»wordpress=&amp;gt;Notion=&amp;gt;github issueéƒ½æ„Ÿè§‰å·®ç‚¹å‘³é“ã€‚
è€Œä¹‹å‰æ„Ÿè§‰é€šè¿‡hexo or hugoè¿™ç§ç¼–è¯‘å‹çš„é™æ€éƒ¨ç½²æ¥è®°å½•åˆå¤ªéº»çƒ¦ï¼Œä½†ç°åœ¨éœ€è¦å®ƒä»¬çš„å¯å®šåˆ¶æ€§ï¼Œç´¢æ€§è¿˜æ˜¯å°è¯•ç”¨hugoæ¥ç»§ç»­è®°å½•å§ã€‚
Why not hexo? written in Go, which it&amp;rsquo;s fast.
About me ä¸»å‰ç«¯ï¼Œä¸è¿‡å…¶å®ƒçš„ä¹Ÿéƒ½æœ‰æ¥è§¦ï¼Œ å¯¹ç½‘ç»œå®‰å…¨æ„Ÿå…´è¶£ï¼Œç®—æ˜¯ä¸€åä¸šä½™è„šæœ¬å°å­ï¼Œ 2022æœ¬ç§‘åº”å±Šç”Ÿï¼Œå³å°†å…¥èŒæŸäº’è”ç½‘å¤§å‚ã€‚</description></item></channel></rss>